

<!-------------------After Partner Post Area------------------------->
<br>
<div class="text-center bg-light text-dark">
    <h3>Partners</h3>
</div>

<!-- <hr> -->
<br>
<div class="row container-fluid bg-3 justify-content-lg-center">
    <div class="col-lg-12" id="partners">

    </div>
</div>

<br>
<script>
    //********************Retrieve and Display Data from Firebase**************************************

    function slugify (text) {
        const a = 'àáäâèéëêìíïîòóöôùúüûñçßÿœæŕśńṕẃǵǹḿǘẍźḧ·/_,:;'
        const b = 'aaaaeeeeiiiioooouuuuncsyoarsnpwgnmuxzh------'
        const p = new RegExp(a.split('').join('|'), 'g')

        return text.toString().toLowerCase()
            .replace(/\s+/g, '-')           // Replace spaces with -
            .replace(p, c =>
                b.charAt(a.indexOf(c)))     // Replace special chars
            .replace(/&/g, '-and-')         // Replace & with 'and'
            .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
            .replace(/\-\-+/g, '-')         // Replace multiple - with single -
            .replace(/^-+/, '')             // Trim - from start of text
            .replace(/-+$/, '')             // Trim - from end of text
        }

    var user = firebase.auth().currentUser;
    var dbPartners = firebase.database().ref().child("Partners").orderByChild("Farm or Business Name");

    dbPartners.on("value", function(partners)
    {
        if(partners.exists())
        {
            var partnersHtml = "";

            partners.forEach(function(singlePartner)
            {
                counter = counter + 1;
                var slug = slugify(singlePartner.key)
                
                partnersHtml += "<ul class='list-group'>";
                        partnersHtml += "<li class='list-group-item' style='text-align: justify;'>";
                            partnersHtml += "<a class='form-control btn btn-light text-black' onclick=changeTo("+singlePartner.val()+")>";
                                partnersHtml += singlePartner.key;
                            partnersHtml += "</a>";
                            partnersHtml += "<button class='btn btn-sm justify-left bg-dark text-white' style='display:inline-block' onclick=deletepartnerRecord('"+singlePartner.key+"')>Delete</button>";
                            partnersHtml += "<button class='btn btn-sm justify-right bg-dark text-white' onclick=editpartnerRecord('"+singlePartner.key+"')>Edit</button>";

                            // partnersHtml += "<div class='form-group' style='text-align: justify-md-center; color: black;'>";
                            //     partnersHtml += "<button class='form-control btn btn-sm justify-left btn-light bg-dark text-white' onclick=deletepartnerRecord('"+singlePartner.key+"')>Delete</button>";
                            //     partnersHtml += "<button class='form-control btn btn-sm btn-light bg-dark text-white' onclick=editpartnerRecord('"+singlePartner.key+"')>Edit</button>";
                            // partnersHtml += "</div>";
                        partnersHtml += "</li> <br>";
                        // partnersHtml += "<div> <img width='1000px' height='550px' src='";
                        //     partnersHtml += singlePartner.val().image;
                        // partnersHtml += "'/> </div> <br>";

                        // partnersHtml += "<div class='row'>";
                        //     partnersHtml += "<div class='col-sm-5'> <p style='color:grey;'>"
                        //                  + "Published by: " + singlePartner.val().userName
                        //                  + "</p> </div>"  + 

                        //                  "<div class='col-sm-3'> <p style='color:grey;'>"
                        //                  + "Time: " + singlePartner.val().time
                        //                  + "</p> </div>"  +

                        //                  "<div class='col-sm-4'> <p style='color:grey; margin-left: 75px;'>"
                        //                  + "Date: " + singlePartner.val().date
                        //                  + "</p> </div>"
                        //                  ;
                        // partnersHtml += "</div> <br>";

                        // partnersHtml += "<div style='text-align: justify; color: black;'>";
                        //     partnersHtml += singlePartner.val().desc;
                        // partnersHtml += "</div> <br>";

                        // partnersHtml += "<div class='form-group' style='text-align: justify-md-center; color: black;'>";
                        //     partnersHtml += "<button class='form-control btn btn-sm justify-left btn-light bg-dark text-white' onclick=deletepartnerRecord('"+singlePartner.key+"')>Delete</button>";
                        //     partnersHtml += "<button class='form-control btn btn-sm btn-light bg-dark text-white' onclick=editpartnerRecord('"+singlePartner.key+"')>Edit</button>";
                        // partnersHtml += "</div>";
                        // partnersHtml += "<div class='form-group' style='text-align: justify; color: black;'>";
                            // partnersHtml += "<button class='form-control btn btn-light bg-dark text-white' onclick=editpartnerRecord('"+singlePartner.key+"')>Edit this Partner</button>";
                        // partnersHtml += "</div>";

                partnersHtml += "</ul>";
            });
            $("#partners").html(partnersHtml);
        }
    });


    function deletepartnerRecord(key)
    {
        console.log('TELL ME....')
        var deleteRef = firebase.database().ref().child("Partners").child(key);
        console.log(slug)
        return deleteRef.remove()
        .then(function()
        {
            console.log("Removed Successfully.");
        })
        .catch(function()
        {
            console.log("Error Occured.")
        });
    }

    function editpartnerRecord(key)
    {
        var editRef = firebase.database().ref().child("Partners").child(key);

        return editRef.edit()
        //onclick="switchView('partners.html')"
        .then(function()
        {
            console.log("Edited Successfully.");
        })
        .catch(function()
        {
            console.log("Error Occured.")
        });
    }

    //********************Ends Here -- Retrieve and Display Data from Firebase**************************************
</script>
<!---------------------Validation and uploading of Post Partners Ends here------------------------->